#################################################################
# teamName used for argocd applicaiton names and namespace names.
#################################################################
teamName: cluster-config
#################################################################
# default Values for app-of-apps-infrastructure helm chart
#################################################################
defaults:
  # argcod application defaults
  finalizers: resources-finalizer.argocd.argoproj.io
  gitopsNamespace: openshift-gitops
  # Helm defaults
  helmRepoUrl: https://rosa-hcp-dedicated-vpc.github.io/helm-repository/
  path: charts
  # Vault plugin defaults.
  plugin: true
  AWS_REGION: "ap-southeast-4"
  AVP_TYPE: "awssecretsmanager"
#################################################################
# INFRASTRUCTURE Charts to be deployed.
#################################################################
infrastructure:
  - chart: cluster-efs
    targetRevision: 0.4.12
    namespace: openshift-cluster-csi-drivers
    values:
      roleArn: arn:aws:iam::808082629126:role/np-hub-rosa-efs-csi-role-iam
      fileSystemId: fs-0718beb50be783f1e
      helper-operator:
        startingCSV: aws-efs-csi-driver-operator.v4.20.0-202511040554
  - chart: compliance-operator
    targetRevision: 1.2.10
    namespace: openshift-compliance
    values:
      helper-operator:
        startingCSV: compliance-operator.v1.7.1
  - chart: overprovisioning
    targetRevision: 0.0.7
    namespace: overprovisioning
    values:
  - chart: cluster-logging
    targetRevision: 0.5.10
    namespace: openshift-logging
    values:
      roleArn: arn:aws:iam::808082629126:role/np-hub-rosa-cloudwatch-role-iam
      region: ap-southeast-2
      helper-operator:
        startingCSV: cluster-logging.v6.2.3
  - chart: acm-operator
    targetRevision: 0.2.14
    namespace: open-cluster-management
    annotations:
      argocd.argoproj.io/compare-options: IgnoreExtraneous
    values:
      helper-operator:
        startingCSV: advanced-cluster-management.v2.14.1
  - chart: rhdh-helm
    targetRevision: 1.3.2
    namespace: backstage
    values:
      keycloakUrl: https://keycloak-rhbk-operator.apps.rosa.np-hub.iqbc.p3.openshiftapps.com
      redhat-developer-hub:
        global:
          clusterRouterBase: apps.rosa.np-hub.iqbc.p3.openshiftapps.com
        upstream:
          backstage:
            extraEnvVars:
              - name: KEYCLOAK_CLIENT_ID
                value: backstage
              - name: KEYCLOAK_CLIENT_SECRET
                valueFrom:
                  secretKeyRef:
                    key: CLIENT_SECRET
                    name: keycloak-client-secret-backstage
              - name: BACKEND_SECRET
                value: "{{ randAlphaNum 24 | b64enc }}"
            appConfig:
              app:
                baseUrl: https://backstage-backstage.apps.rosa.np-hub.iqbc.p3.openshiftapps.com
              backend:
                baseUrl: https://backstage-backstage.apps.rosa.np-hub.iqbc.p3.openshiftapps.com
                cors:
                  origin: https://backstage-backstage.apps.rosa.np-hub.iqbc.p3.openshiftapps.com
                reading:
                  allow:
                    - host: '*.apps.rosa.np-hub.iqbc.p3.openshiftapps.com'
                    - host: 'raw.githubusercontent.com'
                auth:
                  externalAccess:
                    - type: static
                      options:
                        token: "my-backend-secret-token-12345"
                        subject: backstage-server
              auth:
                environment: production
                providers:
                  oidc:
                    production:
                      metadataUrl: https://keycloak-rhbk-operator.apps.rosa.np-hub.iqbc.p3.openshiftapps.com/realms/backstage/.well-known/openid-configuration
                      clientId: backstage
                      clientSecret: 8L4FCxzOKlNIoJd8BloTPjXip1AE9uOj
                      prompt: auto
                      # signIn:
                      #   resolvers:
                      #     - resolver: emailMatchingUserEntityProfileEmail
                      #     - resolver: emailLocalPartMatchingUserEntityName
              session:
                secret: ${BACKEND_SECRET}
              signInPage: oidc
              catalog:
                locations:
                  - target: https://raw.githubusercontent.com/rosa-hcp-dedicated-vpc/helm-repository/main/charts/rhdh-helm/files/showcase-templates.yaml
                    type: url
                    rules:
                      - allow: [Template]
                  - target: https://raw.githubusercontent.com/rosa-hcp-dedicated-vpc/helm-repository/main/charts/rhdh-helm/files/org.yaml
                    type: url
                    rules:
                      - allow: [Group, User]
                  - target: https://raw.githubusercontent.com/rosa-hcp-dedicated-vpc/helm-repository/main/charts/rhdh-helm/files/locations.yaml
                    type: url
                    rules:
                      - allow: [Domain, Component, System, API, Resource, Location]
                providers:
                    keycloakOrg:
                      default:
                        baseUrl: https://keycloak-rhbk-operator.apps.rosa.np-hub.iqbc.p3.openshiftapps.com
                        clientId: backstage
                        clientSecret: 8L4FCxzOKlNIoJd8BloTPjXip1AE9uOj
                        loginRealm: backstage
                        realm: backstage
                        schedule:
                          frequency: { minutes: 1 }
                          timeout: { minutes: 5 }
                          initialDelay: { seconds: 15 }
              argocd:
                appLocatorMethods:
                  - type: 'config'
                    instances:
                      - name: application-gitops
                        url: https://application-gitops-server-application-gitops.apps.rosa.np-hub.iqbc.p3.openshiftapps.com
                        username: admin
                        password: Mjc2NDk2
              kubernetes:
                serviceLocatorMethod:
                  type: "multiTenant"
                clusterLocatorMethods:
                  - type: "config"
                    clusters:
                      - name: dev-cluster-infra
                        url: https://api.np-hub.iqbc.p3.openshiftapps.com:6443
                        authProvider: "serviceAccount"
                        skipTLSVerify: true
                        serviceAccountToken: eyJhbGciOiJSUzI1NiIsImtpZCI6IkFfVHZpekNfUGt1cDROVU53bV8yMVFRNHZHMGExZmszbzNFYjlNMS1tVFkifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJkZWZhdWx0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6ImRlZmF1bHQtdG9rZW4iLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiZGVmYXVsdCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6Ijg5ODQ2N2VmLTM0ZDctNDU4Zi1iMGZkLTYyNTE1ZGQwM2U3OCIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDpkZWZhdWx0OmRlZmF1bHQifQ.AAaOIRtOQyFqbJh9cNUjHwgnL8rnk2DfJb7PkdQDdYV9XgpNePZXZvHdMwaOm3HUoksKOocYY9BmX14utGvoHidgk_-rTgi8vZNp30T2wiw8mdX7P6FLFYYMG2Mlo12FzZZjCybDMjXnKZCDZADSGzVGm12PQu6RwdM-I0nNWmI86tvM9MESvZQLsAx50mNN6ZASRbprn5ikfszAPLjdtUb6gn_TdKRzFqvRR9d4Edwq7ZTLy_x4Ssr2Zq0hfA5Li9zNJJuExy1dmzRYtislYSyLtxXLOUjMx69AK9sB1l1eMBzOI4faAJ34Hw7lhazP9KLnEBbXcLxuLZWpB7oPbMibOsaPttcukgO2Nceylin03SwCuc53AHxPuWNmXws3tSktrj2NJokQ6bUfkEvuR0Q_zj58bVCPZiQlgOYgR5w8VDmT4u0NUASeabjRkUPaeWZGT8u5eYPIOWAKR8QlwRB-xz6BqaAYEqKGxhp8tTxu8J3TI9lJQPU7qp29CSQzfa51L3a8gpnD-ZAtW-MDCy2rrqj6qX9FdTH-Y_u3Cjuuq6lzGeKv3dIoOi5eCilp3GsxlF1xoYxYx4BpHzKIUCc0lNKtWvDEtgy0CNaJYd7E7DS8FNKp296Z7ZE9sdhYq6vuMMydOv9yiA_fKrgUzLF8jIiecWwm5T7_A4yh-M8
                        kubernetes:
          service:
            ports:
              backend: 7007
              targetPort: backend
        route:
          host: backstage-backstage.apps.rosa.np-hub.iqbc.p3.openshiftapps.com
  - chart: rhdh-orchestrator-infra
    targetRevision: 2.0.7 
    namespace: openshift-serverless
  - chart: rhdh-orchestrator-workflows-greeting
    targetRevision: 2.0.8
    namespace: backstage
  - chart: rhbk-operator
    targetRevision: 0.2.4
    namespace: rhbk-operator
    values:
      clientSecret: "np-hub-secret-2"
      clusterDomain: "apps.rosa.np-hub.iqbc.p3.openshiftapps.com"
      subscription:
        startingCSV: "rhbk-operator.v26.4.2-opr.1"
      client:
        redirectUri:
          - https://backstage-backstage.apps.rosa.np-hub.iqbc.p3.openshiftapps.com/api/auth/oidc/handler/frame

  # - chart: orchestrator-operator
  #   targetRevision: 1.0.2
  #   namespace: openshift-operators
  #   values:
  #     helper-operator:
  #       startingCSV: orchestrator-operator.v1.6.1
  # - chart: backstage
  #   targetRevision: 4.5.14
  #   namespace: backstage
  #   annotations:
  #     argocd.argoproj.io/compare-options: IgnoreExtraneous
  #   values:
  #     global:
  #       host: "cluster-config-backstage-developer-hub-backstage.apps.rosa.np-hub.pcx9.p3.openshiftapps.com"
  # - chart: backstage
  #   targetRevision: 4.5.14
  #   namespace: backstage
  #   annotations:
  #     argocd.argoproj.io/compare-options: IgnoreExtraneous
  #   values:
  #     global:
  #       host: "cluster-config-backstage-developer-hub-backstage.apps.rosa.np-hub.pcx9.p3.openshiftapps.com"

  # - chart: orchestrator-software-templates-infra
  #   targetRevision: 0.2.6
  #   namespace: openshift-operators
  #   values:
  #     startingCSV: advanced-cluster-management.v2.13.4


  # - chart: rhacs-operator
  #   targetRevision: 0.1.8
  #   namespace: rhacs-operator
  #   values:
  #     helper-operator:
  #       startingCSV: rhacs-operator.v4.7.4
        
